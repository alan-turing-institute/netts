
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../img/favicon_io/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.13">
    
    
      
        <title>Python - Netts</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e411adfe.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cc9b2e1e.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#netts-package" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Netts" class="md-header__button md-logo" aria-label="Netts" data-md-component="logo">
      
  <img src="../img/favicon_io/favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Netts
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Python
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/alan-turing-institute/netts" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    alan-turing-institute/netts
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Netts" class="md-nav__button md-logo" aria-label="Netts" data-md-component="logo">
      
  <img src="../img/favicon_io/favicon.ico" alt="logo">

    </a>
    Netts
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/alan-turing-institute/netts" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    alan-turing-institute/netts
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Usage" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Command Line
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Command Line" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Command Line
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cli_basics/" class="md-nav__link">
        Basic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        Options
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        Advanced
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Python
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#process-a-single-transcript" class="md-nav__link">
    Process a single transcript
  </a>
  
    <nav class="md-nav" aria-label="Process a single transcript">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-the-corenlp-and-openie5-servers" class="md-nav__link">
    Start the CoreNLP and OpenIE5 servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-a-transcript" class="md-nav__link">
    Process a transcript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-graph-and-save-outputs" class="md-nav__link">
    Plot graph and save outputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#refining-the-plot" class="md-nav__link">
    Refining the plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../post-processing/" class="md-nav__link">
        Analysing networks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../pipeline/" class="md-nav__link">
        Pipeline
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#process-a-single-transcript" class="md-nav__link">
    Process a single transcript
  </a>
  
    <nav class="md-nav" aria-label="Process a single transcript">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-the-corenlp-and-openie5-servers" class="md-nav__link">
    Start the CoreNLP and OpenIE5 servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-a-transcript" class="md-nav__link">
    Process a transcript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-graph-and-save-outputs" class="md-nav__link">
    Plot graph and save outputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#refining-the-plot" class="md-nav__link">
    Refining the plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/alan-turing-institute/netts/edit/master/docs/python_basics.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="netts-package">Netts package</h1>
<p>If you dont want to use the netts command line interface (CLI) or want more control over netts you can use the netts python package directly. Here we'll run through the <a href="/cli_basics">CLI example</a> in Python.</p>
<p>Make sure you have a transcript in your working directory.</p>
<details>
<summary>Follow along - Example transcript</summary>
To follow along create this example in a file by running the following command in a terminal

<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;I see a man and he is wearing a jacket. He is standing in the dark against a light post. On the picture there seems to be like a park and... Or trees but in those trees there are little balls of light reflections as well. I cannot see the... Anything else because itâ€™s very dark. But the man on the picture seems to wear a hat and he seems to have a hoodie on as well. The picture is very mysterious, which I like about it, but for me I would like to understand more about the picture.&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>transcript.txt
</code></pre></div>

</details>

<h2 id="process-a-single-transcript">Process a single transcript</h2>
<p>We can then process a single transcript using the following Python script, which we'll run through step by step.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">netts</span>

<span class="hll"><span class="n">settings</span> <span class="o">=</span> <span class="n">netts</span><span class="o">.</span><span class="n">get_settings</span><span class="p">()</span>
</span><span class="hll"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Installing dependencies to </span><span class="si">{</span><span class="n">settings</span><span class="o">.</span><span class="n">netts_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="n">netts</span><span class="o">.</span><span class="n">install_dependencies</span><span class="p">()</span>
</span>
<span class="k">with</span> <span class="n">netts</span><span class="o">.</span><span class="n">OpenIEClient</span><span class="p">()</span> <span class="k">as</span> <span class="n">openie_client</span><span class="p">,</span> <span class="n">netts</span><span class="o">.</span><span class="n">CoreNLPClient</span><span class="p">(</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;annotators&quot;</span><span class="p">:</span> <span class="s2">&quot;tokenize,ssplit,pos,lemma,parse,depparse,coref,openie&quot;</span><span class="p">},</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">corenlp_client</span><span class="p">:</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;transcript.txt&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">transcript</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">graph</span> <span class="o">=</span> <span class="n">netts</span><span class="o">.</span><span class="n">SpeechGraph</span><span class="p">(</span><span class="n">transcript</span><span class="p">)</span>

    <span class="n">graph</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
        <span class="n">openie_client</span><span class="o">=</span><span class="n">openie_client</span><span class="p">,</span>
        <span class="n">corenlp_client</span><span class="o">=</span><span class="n">corenlp_client</span><span class="p">,</span>
        <span class="n">preprocess_config</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">netts_config</span><span class="o">.</span><span class="n">preprocess</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;transcript.png&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;transcript.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_f</span><span class="p">:</span>
    <span class="n">netts</span><span class="o">.</span><span class="n">pickle_graph</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">output_f</span><span class="p">)</span>
</code></pre></div>
<p>First we load a <code>Settings</code> object which provides information about the netts configuration. We then check where netts will install addition dependencies, and finally download them. This can take a long time (~20min), so time to put the kettle on.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>If the dependencies have already been installed this function will do nothing.</p>
</div>
<h3 id="start-the-corenlp-and-openie5-servers">Start the CoreNLP and OpenIE5 servers</h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">netts</span>

<span class="n">settings</span> <span class="o">=</span> <span class="n">netts</span><span class="o">.</span><span class="n">get_settings</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Installing dependencies to </span><span class="si">{</span><span class="n">settings</span><span class="o">.</span><span class="n">netts_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">netts</span><span class="o">.</span><span class="n">install_dependencies</span><span class="p">()</span>

<span class="hll"><span class="k">with</span> <span class="n">netts</span><span class="o">.</span><span class="n">OpenIEClient</span><span class="p">()</span> <span class="k">as</span> <span class="n">openie_client</span><span class="p">,</span> <span class="n">netts</span><span class="o">.</span><span class="n">CoreNLPClient</span><span class="p">(</span>
</span><span class="hll">    <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;annotators&quot;</span><span class="p">:</span> <span class="s2">&quot;tokenize,ssplit,pos,lemma,parse,depparse,coref,openie&quot;</span><span class="p">},</span>
</span><span class="hll"><span class="p">)</span> <span class="k">as</span> <span class="n">corenlp_client</span><span class="p">:</span>
</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;transcript.txt&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">transcript</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">graph</span> <span class="o">=</span> <span class="n">netts</span><span class="o">.</span><span class="n">SpeechGraph</span><span class="p">(</span><span class="n">transcript</span><span class="p">)</span>

    <span class="n">graph</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
        <span class="n">openie_client</span><span class="o">=</span><span class="n">openie_client</span><span class="p">,</span>
        <span class="n">corenlp_client</span><span class="o">=</span><span class="n">corenlp_client</span><span class="p">,</span>
        <span class="n">preprocess_config</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">netts_config</span><span class="o">.</span><span class="n">preprocess</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;transcript.png&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;transcript.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_f</span><span class="p">:</span>
    <span class="n">netts</span><span class="o">.</span><span class="n">pickle_graph</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">output_f</span><span class="p">)</span>
</code></pre></div>
<p>Netts uses <a href="https://github.com/dair-iitd/OpenIE-standalone">Openie5</a> and <a href="https://stanfordnlp.github.io/CoreNLP/">CoreNLP</a> under the hood. These are both <a href="https://en.wikipedia.org/wiki/Java_(programming_language)">Java</a> programmes that we installed in the previous step. We use a <a href="https://book.pythontips.com/en/latest/context_managers.html">context manager</a> to start the servers, which makes sure they are both automatically shut down when processing finishes.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The servers are extremely memory hungry, using ~8GB. If the server fails to start you probably ran out of memory and failed silently. Try on a machine with more memory.</p>
</div>
<h3 id="process-a-transcript">Process a transcript</h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">netts</span>

<span class="n">settings</span> <span class="o">=</span> <span class="n">netts</span><span class="o">.</span><span class="n">get_settings</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Installing dependencies to </span><span class="si">{</span><span class="n">settings</span><span class="o">.</span><span class="n">netts_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">netts</span><span class="o">.</span><span class="n">install_dependencies</span><span class="p">()</span>

<span class="k">with</span> <span class="n">netts</span><span class="o">.</span><span class="n">OpenIEClient</span><span class="p">()</span> <span class="k">as</span> <span class="n">openie_client</span><span class="p">,</span> <span class="n">netts</span><span class="o">.</span><span class="n">CoreNLPClient</span><span class="p">(</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;annotators&quot;</span><span class="p">:</span> <span class="s2">&quot;tokenize,ssplit,pos,lemma,parse,depparse,coref,openie&quot;</span><span class="p">},</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">corenlp_client</span><span class="p">:</span>

<span class="hll">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;transcript.txt&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span class="hll">        <span class="n">transcript</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span class="hll">
</span><span class="hll">    <span class="n">graph</span> <span class="o">=</span> <span class="n">netts</span><span class="o">.</span><span class="n">SpeechGraph</span><span class="p">(</span><span class="n">transcript</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">    <span class="n">graph</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span class="hll">        <span class="n">openie_client</span><span class="o">=</span><span class="n">openie_client</span><span class="p">,</span>
</span><span class="hll">        <span class="n">corenlp_client</span><span class="o">=</span><span class="n">corenlp_client</span><span class="p">,</span>
</span><span class="hll">        <span class="n">preprocess_config</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">netts_config</span><span class="o">.</span><span class="n">preprocess</span><span class="p">,</span>
</span><span class="hll">    <span class="p">)</span>
</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;transcript.png&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;transcript.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_f</span><span class="p">:</span>
    <span class="n">netts</span><span class="o">.</span><span class="n">pickle_graph</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">output_f</span><span class="p">)</span>
</code></pre></div>
<p>Next we load our transcript into memory, create a <code>SpeechGraph</code> object and then call its <code>process</code> method, passing our two servers and a configuration object.</p>
<p>Here we use a default configuration object <code>settings.netts_config.preprocess</code>.</p>
<h3 id="plot-graph-and-save-outputs">Plot graph and save outputs</h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">netts</span>

<span class="n">settings</span> <span class="o">=</span> <span class="n">netts</span><span class="o">.</span><span class="n">get_settings</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Installing dependencies to </span><span class="si">{</span><span class="n">settings</span><span class="o">.</span><span class="n">netts_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">netts</span><span class="o">.</span><span class="n">install_dependencies</span><span class="p">()</span>

<span class="k">with</span> <span class="n">netts</span><span class="o">.</span><span class="n">OpenIEClient</span><span class="p">()</span> <span class="k">as</span> <span class="n">openie_client</span><span class="p">,</span> <span class="n">netts</span><span class="o">.</span><span class="n">CoreNLPClient</span><span class="p">(</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;annotators&quot;</span><span class="p">:</span> <span class="s2">&quot;tokenize,ssplit,pos,lemma,parse,depparse,coref,openie&quot;</span><span class="p">},</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">corenlp_client</span><span class="p">:</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;transcript.txt&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">transcript</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">graph</span> <span class="o">=</span> <span class="n">netts</span><span class="o">.</span><span class="n">SpeechGraph</span><span class="p">(</span><span class="n">transcript</span><span class="p">)</span>

    <span class="n">graph</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
        <span class="n">openie_client</span><span class="o">=</span><span class="n">openie_client</span><span class="p">,</span>
        <span class="n">corenlp_client</span><span class="o">=</span><span class="n">corenlp_client</span><span class="p">,</span>
        <span class="n">preprocess_config</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">netts_config</span><span class="o">.</span><span class="n">preprocess</span><span class="p">,</span>
    <span class="p">)</span>

<span class="hll"><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span class="hll"><span class="n">graph</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll"><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;transcript.png&quot;</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;transcript.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_f</span><span class="p">:</span>
</span><span class="hll">    <span class="n">netts</span><span class="o">.</span><span class="n">pickle_graph</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">output_f</span><span class="p">)</span>
</span></code></pre></div>
<p>Finally we plot our graph, save it to file and also <a href="https://docs.python.org/3/library/pickle.html">pickle</a> our graph object for further analysis later.</p>
<h3 id="refining-the-plot">Refining the plot</h3>
<p>The network is plotted using <a href="https://en.wikipedia.org/wiki/Force-directed_graph_drawing">spring-embedding</a>, which tries to plot the network such that you get the least overlapping of nodes and edges with each other. This also means that each time you plot the network, it will look slightly different. If you are not happy with the way your network is plotted, try re-running the last few lines of code and look at the transcript.png image file again:</p>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;transcript.png&quot;</span><span class="p">)</span>
</code></pre></div>
<p>You can also open the figure in an interactive window by running:</p>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>When resizing the window, we see that the network automatically adjusts to the new window size and the nodes and edges spread out. This usually helps visualisation a lot. We therefore recommend trying out this step when processing your first few transcripts and inspecting the networks.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../configuration/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Advanced" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Advanced
            </div>
          </div>
        </a>
      
      
        
        <a href="../post-processing/" class="md-footer__link md-footer__link--next" aria-label="Next: Analysing networks" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Analysing networks
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ed9748b7.min.js"></script>
      
    
  </body>
</html>